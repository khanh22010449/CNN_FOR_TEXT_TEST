2025-04-06 17:22:23,664 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_setup.py:_flush():67] Current SDK version is 0.19.9
2025-04-06 17:22:23,664 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_setup.py:_flush():67] Configure stats pid to 47376
2025-04-06 17:22:23,664 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_setup.py:_flush():67] Loading settings from C:\Users\khanh\.config\wandb\settings
2025-04-06 17:22:23,664 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_setup.py:_flush():67] Loading settings from C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\wandb\settings
2025-04-06 17:22:23,664 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_setup.py:_flush():67] Loading settings from environment variables
2025-04-06 17:22:23,665 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_init.py:setup_run_log_directory():662] Logging user logs to C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\wandb\run-20250406_172223-9f0lkrvt\logs\debug.log
2025-04-06 17:22:23,665 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_init.py:setup_run_log_directory():663] Logging internal logs to C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\wandb\run-20250406_172223-9f0lkrvt\logs\debug-internal.log
2025-04-06 17:22:23,665 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_init.py:init():781] calling init triggers
2025-04-06 17:22:23,666 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_init.py:init():786] wandb.init called with sweep_config: {}
config: {'_wandb': {}}
2025-04-06 17:22:23,666 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_init.py:init():809] starting backend
2025-04-06 17:22:23,666 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_init.py:init():813] sending inform_init request
2025-04-06 17:22:23,737 INFO    Thread-1 (server_th_with_start_checks):47376 [backend.py:_multiprocessing_setup():101] multiprocessing start_methods=spawn, using: spawn
2025-04-06 17:22:23,737 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_init.py:init():823] backend started and connected
2025-04-06 17:22:23,740 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_init.py:init():915] updated telemetry
2025-04-06 17:22:23,850 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_init.py:init():939] communicating run to backend with 90.0 second timeout
2025-04-06 17:22:25,186 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_init.py:init():1014] starting run threads in backend
2025-04-06 17:22:25,880 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_run.py:_console_start():2454] atexit reg
2025-04-06 17:22:25,880 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_run.py:_redirect():2306] redirect: wrap_raw
2025-04-06 17:22:25,881 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_run.py:_redirect():2371] Wrapping output streams.
2025-04-06 17:22:25,881 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_run.py:_redirect():2394] Redirects installed.
2025-04-06 17:22:25,901 INFO    Thread-1 (server_th_with_start_checks):47376 [wandb_init.py:init():1056] run started, returning control to user process
2025-04-06 17:27:24,530 WARNING MsgRouterThr:47376 [router.py:message_loop():63] [no run ID] message_loop has been closed
Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 208, in _read_packet_bytes
    data = self._sock.recv(self._bufsize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\router_sock.py", line 27, in _read_message
    return self._sock_client.read_server_response(timeout=1)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 235, in read_server_response
    data = self._read_packet_bytes(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 212, in _read_packet_bytes
    raise SockClientClosedError from e
wandb.sdk.lib.sock_client.SockClientClosedError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\router.py", line 56, in message_loop
    msg = self._read_message()
          ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\router_sock.py", line 29, in _read_message
    raise MessageRouterClosedError from e
wandb.sdk.interface.router.MessageRouterClosedError
2025-04-06 17:27:24,594 ERROR   ray_listen_error_messages:47376 [redirect.py:_on_write():661] [no run ID] error in stdout callback
Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\redirect.py", line 659, in _on_write
    cb(written_data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 2375, in <lambda>
    lambda data: self._console_raw_callback("stdout", data),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 387, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 435, in wrapper_fn
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 1518, in _console_raw_callback
    self._backend.interface.publish_output_raw(name, data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface.py", line 761, in publish_output_raw
    self._publish_output_raw(o)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_shared.py", line 38, in _publish_output_raw
    self._publish(rec)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_sock.py", line 39, in _publish
    self._sock_client.send_record_publish(record)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 174, in send_record_publish
    self.send_server_request(server_req)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 154, in send_server_request
    self._send_message(msg)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 151, in _send_message
    self._sendall_with_error_handle(header + data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
           ^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
2025-04-06 17:27:24,680 ERROR   ThreadPoolExecutor-1_0:47376 [redirect.py:_on_write():661] [no run ID] error in stderr callback
Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\redirect.py", line 659, in _on_write
    cb(written_data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 2381, in <lambda>
    lambda data: self._console_raw_callback("stderr", data),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 387, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 435, in wrapper_fn
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 1518, in _console_raw_callback
    self._backend.interface.publish_output_raw(name, data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface.py", line 761, in publish_output_raw
    self._publish_output_raw(o)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_shared.py", line 38, in _publish_output_raw
    self._publish(rec)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_sock.py", line 39, in _publish
    self._sock_client.send_record_publish(record)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 174, in send_record_publish
    self.send_server_request(server_req)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 154, in send_server_request
    self._send_message(msg)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 151, in _send_message
    self._sendall_with_error_handle(header + data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
           ^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
2025-04-06 17:27:24,796 ERROR   ray_print_logs:47376 [redirect.py:_on_write():661] [no run ID] error in stderr callback
Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\redirect.py", line 659, in _on_write
    cb(written_data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 2381, in <lambda>
    lambda data: self._console_raw_callback("stderr", data),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 387, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 435, in wrapper_fn
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 1518, in _console_raw_callback
    self._backend.interface.publish_output_raw(name, data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface.py", line 761, in publish_output_raw
    self._publish_output_raw(o)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_shared.py", line 38, in _publish_output_raw
    self._publish(rec)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_sock.py", line 39, in _publish
    self._sock_client.send_record_publish(record)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 174, in send_record_publish
    self.send_server_request(server_req)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 154, in send_server_request
    self._send_message(msg)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 151, in _send_message
    self._sendall_with_error_handle(header + data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
           ^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
2025-04-06 17:27:25,100 INFO    MsgRouterThr:47376 [mailbox.py:close():129] [no run ID] Closing mailbox, abandoning 1 handles.
2025-04-06 17:27:25,113 ERROR   ray_listen_error_messages:47376 [redirect.py:_on_write():661] [no run ID] error in stdout callback
Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\redirect.py", line 659, in _on_write
    cb(written_data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 2375, in <lambda>
    lambda data: self._console_raw_callback("stdout", data),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 387, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 435, in wrapper_fn
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 1518, in _console_raw_callback
    self._backend.interface.publish_output_raw(name, data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface.py", line 761, in publish_output_raw
    self._publish_output_raw(o)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_shared.py", line 38, in _publish_output_raw
    self._publish(rec)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_sock.py", line 39, in _publish
    self._sock_client.send_record_publish(record)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 174, in send_record_publish
    self.send_server_request(server_req)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 154, in send_server_request
    self._send_message(msg)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 151, in _send_message
    self._sendall_with_error_handle(header + data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
           ^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
2025-04-06 17:27:25,117 ERROR   ThreadPoolExecutor-1_2:47376 [redirect.py:_on_write():661] [no run ID] error in stderr callback
Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\redirect.py", line 659, in _on_write
    cb(written_data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 2381, in <lambda>
    lambda data: self._console_raw_callback("stderr", data),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 387, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 435, in wrapper_fn
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 1518, in _console_raw_callback
    self._backend.interface.publish_output_raw(name, data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface.py", line 761, in publish_output_raw
    self._publish_output_raw(o)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_shared.py", line 38, in _publish_output_raw
    self._publish(rec)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_sock.py", line 39, in _publish
    self._sock_client.send_record_publish(record)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 174, in send_record_publish
    self.send_server_request(server_req)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 154, in send_server_request
    self._send_message(msg)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 151, in _send_message
    self._sendall_with_error_handle(header + data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
           ^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
2025-04-06 17:27:25,120 ERROR   ray_print_logs:47376 [redirect.py:_on_write():661] [no run ID] error in stderr callback
Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\redirect.py", line 659, in _on_write
    cb(written_data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 2381, in <lambda>
    lambda data: self._console_raw_callback("stderr", data),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 387, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 435, in wrapper_fn
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 1518, in _console_raw_callback
    self._backend.interface.publish_output_raw(name, data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface.py", line 761, in publish_output_raw
    self._publish_output_raw(o)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_shared.py", line 38, in _publish_output_raw
    self._publish(rec)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_sock.py", line 39, in _publish
    self._sock_client.send_record_publish(record)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 174, in send_record_publish
    self.send_server_request(server_req)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 154, in send_server_request
    self._send_message(msg)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 151, in _send_message
    self._sendall_with_error_handle(header + data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
           ^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
2025-04-06 17:27:25,123 ERROR   ray_listen_error_messages:47376 [redirect.py:_on_write():661] [no run ID] error in stdout callback
Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\redirect.py", line 659, in _on_write
    cb(written_data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 2375, in <lambda>
    lambda data: self._console_raw_callback("stdout", data),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 387, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 435, in wrapper_fn
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 1518, in _console_raw_callback
    self._backend.interface.publish_output_raw(name, data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface.py", line 761, in publish_output_raw
    self._publish_output_raw(o)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_shared.py", line 38, in _publish_output_raw
    self._publish(rec)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_sock.py", line 39, in _publish
    self._sock_client.send_record_publish(record)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 174, in send_record_publish
    self.send_server_request(server_req)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 154, in send_server_request
    self._send_message(msg)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 151, in _send_message
    self._sendall_with_error_handle(header + data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
           ^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
2025-04-06 17:27:25,141 ERROR   ThreadPoolExecutor-1_3:47376 [redirect.py:_on_write():661] [no run ID] error in stderr callback
Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\redirect.py", line 659, in _on_write
    cb(written_data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 2381, in <lambda>
    lambda data: self._console_raw_callback("stderr", data),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 387, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 435, in wrapper_fn
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 1518, in _console_raw_callback
    self._backend.interface.publish_output_raw(name, data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface.py", line 761, in publish_output_raw
    self._publish_output_raw(o)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_shared.py", line 38, in _publish_output_raw
    self._publish(rec)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_sock.py", line 39, in _publish
    self._sock_client.send_record_publish(record)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 174, in send_record_publish
    self.send_server_request(server_req)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 154, in send_server_request
    self._send_message(msg)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 151, in _send_message
    self._sendall_with_error_handle(header + data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
           ^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
2025-04-06 17:27:25,165 ERROR   ray_print_logs:47376 [redirect.py:_on_write():661] [no run ID] error in stderr callback
Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\redirect.py", line 659, in _on_write
    cb(written_data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 2381, in <lambda>
    lambda data: self._console_raw_callback("stderr", data),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 387, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 435, in wrapper_fn
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 1518, in _console_raw_callback
    self._backend.interface.publish_output_raw(name, data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface.py", line 761, in publish_output_raw
    self._publish_output_raw(o)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_shared.py", line 38, in _publish_output_raw
    self._publish(rec)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_sock.py", line 39, in _publish
    self._sock_client.send_record_publish(record)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 174, in send_record_publish
    self.send_server_request(server_req)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 154, in send_server_request
    self._send_message(msg)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 151, in _send_message
    self._sendall_with_error_handle(header + data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
           ^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
2025-04-06 17:27:25,166 ERROR   ray_listen_error_messages:47376 [redirect.py:_on_write():661] [no run ID] error in stdout callback
Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\redirect.py", line 659, in _on_write
    cb(written_data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 2375, in <lambda>
    lambda data: self._console_raw_callback("stdout", data),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 387, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 435, in wrapper_fn
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 1518, in _console_raw_callback
    self._backend.interface.publish_output_raw(name, data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface.py", line 761, in publish_output_raw
    self._publish_output_raw(o)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_shared.py", line 38, in _publish_output_raw
    self._publish(rec)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_sock.py", line 39, in _publish
    self._sock_client.send_record_publish(record)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 174, in send_record_publish
    self.send_server_request(server_req)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 154, in send_server_request
    self._send_message(msg)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 151, in _send_message
    self._sendall_with_error_handle(header + data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
           ^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
2025-04-06 17:27:25,247 ERROR   ThreadPoolExecutor-1_1:47376 [redirect.py:_on_write():661] [no run ID] error in stderr callback
Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 931, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ClientAppActor
	actor_id: 638ea3efa6bacfbdcf9d07c101000000
	pid: 43640
	namespace: 962da485-33d7-466e-80f4-8bf7986a849e
	ip: 127.0.0.1
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker unexpectedly exits with a connection error code 10054. An existing connection was forcibly closed by the remote host. There are some potential root causes. (1) The process is killed by SIGKILL by OOM killer due to high memory usage. (2) ray stop --force is called. (3) The worker is crashed unexpectedly due to SIGSEGV or other unexpected errors.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\redirect.py", line 659, in _on_write
    cb(written_data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 2381, in <lambda>
    lambda data: self._console_raw_callback("stderr", data),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 387, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 435, in wrapper_fn
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 1518, in _console_raw_callback
    self._backend.interface.publish_output_raw(name, data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface.py", line 761, in publish_output_raw
    self._publish_output_raw(o)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_shared.py", line 38, in _publish_output_raw
    self._publish(rec)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_sock.py", line 39, in _publish
    self._sock_client.send_record_publish(record)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 174, in send_record_publish
    self.send_server_request(server_req)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 154, in send_server_request
    self._send_message(msg)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 151, in _send_message
    self._sendall_with_error_handle(header + data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
           ^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
2025-04-06 17:27:25,440 ERROR   ray_print_logs:47376 [redirect.py:_on_write():661] [no run ID] error in stderr callback
Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\redirect.py", line 659, in _on_write
    cb(written_data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 2381, in <lambda>
    lambda data: self._console_raw_callback("stderr", data),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 387, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 435, in wrapper_fn
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 1518, in _console_raw_callback
    self._backend.interface.publish_output_raw(name, data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface.py", line 761, in publish_output_raw
    self._publish_output_raw(o)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_shared.py", line 38, in _publish_output_raw
    self._publish(rec)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_sock.py", line 39, in _publish
    self._sock_client.send_record_publish(record)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 174, in send_record_publish
    self.send_server_request(server_req)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 154, in send_server_request
    self._send_message(msg)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 151, in _send_message
    self._sendall_with_error_handle(header + data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
           ^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
2025-04-06 17:27:25,444 ERROR   ray_listen_error_messages:47376 [redirect.py:_on_write():661] [no run ID] error in stdout callback
Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\redirect.py", line 659, in _on_write
    cb(written_data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 2375, in <lambda>
    lambda data: self._console_raw_callback("stdout", data),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 387, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 435, in wrapper_fn
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 1518, in _console_raw_callback
    self._backend.interface.publish_output_raw(name, data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface.py", line 761, in publish_output_raw
    self._publish_output_raw(o)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_shared.py", line 38, in _publish_output_raw
    self._publish(rec)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_sock.py", line 39, in _publish
    self._sock_client.send_record_publish(record)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 174, in send_record_publish
    self.send_server_request(server_req)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 154, in send_server_request
    self._send_message(msg)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 151, in _send_message
    self._sendall_with_error_handle(header + data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
           ^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
2025-04-06 17:27:25,445 ERROR   ThreadPoolExecutor-1_0:47376 [redirect.py:_on_write():661] [no run ID] error in stderr callback
Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\redirect.py", line 659, in _on_write
    cb(written_data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 2381, in <lambda>
    lambda data: self._console_raw_callback("stderr", data),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 387, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 435, in wrapper_fn
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\wandb_run.py", line 1518, in _console_raw_callback
    self._backend.interface.publish_output_raw(name, data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface.py", line 761, in publish_output_raw
    self._publish_output_raw(o)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_shared.py", line 38, in _publish_output_raw
    self._publish(rec)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\interface\interface_sock.py", line 39, in _publish
    self._sock_client.send_record_publish(record)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 174, in send_record_publish
    self.send_server_request(server_req)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 154, in send_server_request
    self._send_message(msg)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 151, in _send_message
    self._sendall_with_error_handle(header + data)
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\wandb\sdk\lib\sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
           ^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
