C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\google\protobuf\internal\well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
[92mINFO [0m:      Starting Flower ServerApp, config: num_rounds=50, no round_timeout
[92mINFO [0m:
[92mINFO [0m:      [INIT]
[92mINFO [0m:      Using initial global parameters provided by strategy
[92mINFO [0m:      Starting evaluation of initial global parameters
Validation Accuracy: 0.4977
[92mINFO [0m:      ðŸ’¡ New best global model found: 0.497674
[92mINFO [0m:      initial parameters (loss, other metrics): 0.7497278451919556, {'centralized_accuracy': 0.49767441860465117}
[92mINFO [0m:
[92mINFO [0m:      [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 50 clients (out of 100)
[36m(ClientAppActor pid=12216)[0m [92mINFO [0m:      Client 73 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}
[36m(pid=45540)[0m 2025-04-06 17:22:21.251854: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Global vocab size: 4481
[36m(ClientAppActor pid=43640)[0m C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\datasets\utils\_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=43640)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
Map:   0%|          | 0/39 [00:00<?, ? examples/s]
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 60 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 3x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 1208.27 examples/s]
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 44 - Vocab size: 4481
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1101.22 examples/s]
[36m(ClientAppActor pid=12216)[0m Epoch 100/100, Loss: 33.1461
[36m(ClientAppActor pid=12216)[0m [92mINFO [0m:      Global vocab size: 4481[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=9860)[0m C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\datasets\utils\_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=9860)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args][32m [repeated 4x across cluster][0m
Map:   0%|          | 0/38 [00:00<?, ? examples/s][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 92 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1199.63 examples/s]
[36m(ClientAppActor pid=12216)[0m [92mINFO [0m:      Client 73 - Vocab size: 4481[32m [repeated 3x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 1048.38 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 921.34 examples/s]
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 94 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}
[36m(ClientAppActor pid=9860)[0m Epoch 100/100, Loss: 33.2942[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\datasets\utils\_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=43640)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args][32m [repeated 3x across cluster][0m
Map:   0%|          | 0/39 [00:00<?, ? examples/s][32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 9 - Vocab size: 4481[32m [repeated 4x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1086.31 examples/s][32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 81 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 3x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 1451.12 examples/s]
[36m(ClientAppActor pid=9860)[0m Epoch 100/100, Loss: 31.9343[32m [repeated 4x across cluster][0m
Map:   0%|          | 0/39 [00:00<?, ? examples/s]
[36m(ClientAppActor pid=12216)[0m [92mINFO [0m:      Client 59 - Vocab size: 4481[32m [repeated 4x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 988.77 examples/s]
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 18 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1311.12 examples/s][32m [repeated 2x across cluster][0m
Map:   0%|          | 0/39 [00:00<?, ? examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1009.62 examples/s]
[36m(ClientAppActor pid=9860)[0m Epoch 100/100, Loss: 35.5752[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=12216)[0m [92mINFO [0m:      Client 38 - Vocab size: 4481[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 56 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1436.04 examples/s][32m [repeated 3x across cluster][0m
Map:   0%|          | 0/39 [00:00<?, ? examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 834.18 examples/s]
[36m(ClientAppActor pid=9860)[0m Epoch 100/100, Loss: 36.5130[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=12216)[0m [92mINFO [0m:      Client 4 - Vocab size: 4481[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 48 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 967.26 examples/s][32m [repeated 3x across cluster][0m
Map:   0%|          | 0/39 [00:00<?, ? examples/s][32m [repeated 2x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 760.95 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1088.78 examples/s]
[36m(ClientAppActor pid=9860)[0m Epoch 100/100, Loss: 35.1396[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 55 - Vocab size: 4481[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 98 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1308.33 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1034.20 examples/s]
Map:   0%|          | 0/38 [00:00<?, ? examples/s][32m [repeated 2x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 311.59 examples/s][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=9860)[0m Epoch 100/100, Loss: 33.8697[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 67 - Vocab size: 4481[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 89 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 1126.11 examples/s]
[36m(ClientAppActor pid=12216)[0m Epoch 100/100, Loss: 30.6344[32m [repeated 2x across cluster][0m
Map:   0%|          | 0/39 [00:00<?, ? examples/s][32m [repeated 3x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 771.87 examples/s][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 34 - Vocab size: 4481[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 8 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 2x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1103.36 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 956.52 examples/s]
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 37.0937[32m [repeated 4x across cluster][0m
Map:   0%|          | 0/39 [00:00<?, ? examples/s][32m [repeated 2x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1370.39 examples/s][32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 19 - Vocab size: 4481[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=12216)[0m [92mINFO [0m:      Client 20 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1114.97 examples/s]
[36m(ClientAppActor pid=12216)[0m Epoch 100/100, Loss: 31.9056[32m [repeated 4x across cluster][0m
Map:   0%|          | 0/39 [00:00<?, ? examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1110.21 examples/s]
[36m(ClientAppActor pid=12216)[0m [92mINFO [0m:      Client 40 - Vocab size: 4481[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=12216)[0m [92mINFO [0m:      Client 40 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1554.95 examples/s][32m [repeated 3x across cluster][0m
Map:   0%|          | 0/39 [00:00<?, ? examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1225.28 examples/s]
[36m(ClientAppActor pid=12216)[0m Epoch 100/100, Loss: 35.3095[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 96 - Vocab size: 4481[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=12216)[0m [92mINFO [0m:      Client 82 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 1541.38 examples/s]
Map:   0%|          | 0/39 [00:00<?, ? examples/s]
Map:   0%|          | 0/38 [00:00<?, ? examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 798.94 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 1399.54 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 1588.29 examples/s]
[36m(ClientAppActor pid=12216)[0m Epoch 100/100, Loss: 34.3453[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 71 - Vocab size: 4481[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=12216)[0m [92mINFO [0m:      Client 39 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map:   0%|          | 0/39 [00:00<?, ? examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1333.27 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1301.40 examples/s][32m [repeated 3x across cluster][0m
Map:   0%|          | 0/38 [00:00<?, ? examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 498.65 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 98.14 examples/s] 
[36m(ClientAppActor pid=12216)[0m Epoch 100/100, Loss: 31.1851[32m [repeated 4x across cluster][0m
[92mINFO [0m:      aggregate_fit: received 50 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
Validation Accuracy: 0.4977
[92mINFO [0m:      fit progress: (1, 0.7014236450195312, {'centralized_accuracy': 0.49767441860465117}, 114.58705090000876)
[92mINFO [0m:      configure_evaluate: strategy sampled 50 clients (out of 100)
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 64 - Vocab size: 4481[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 8 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map:   0%|          | 0/38 [00:00<?, ? examples/s]
Map:   0%|          | 0/38 [00:00<?, ? examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 505.92 examples/s]
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 95 - Vocab size: 4481[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=12216)[0m [92mINFO [0m:      Client 58 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=43640)[0m Validation Accuracy: 0.5000
[36m(ClientAppActor pid=45540)[0m Epoch 100/100, Loss: 35.4423[32m [repeated 3x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 1262.34 examples/s]
Map:   0%|          | 0/39 [00:00<?, ? examples/s][32m [repeated 8x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 412.90 examples/s][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 75 - Vocab size: 4481[32m [repeated 34x across cluster][0m
[36m(ClientAppActor pid=12216)[0m [92mINFO [0m:      Client 48 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 34x across cluster][0m
[36m(ClientAppActor pid=12216)[0m Validation Accuracy: 0.5000[32m [repeated 41x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1880.08 examples/s][32m [repeated 7x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 102.58 examples/s]
Map:   0%|          | 0/39 [00:00<?, ? examples/s][32m [repeated 6x across cluster][0m
[92mINFO [0m:      aggregate_evaluate: received 50 results and 0 failures
[92mINFO [0m:
[92mINFO [0m:      [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 50 clients (out of 100)
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 40.05 examples/s][32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 92 - Vocab size: 4481[32m [repeated 15x across cluster][0m
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 92 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 14x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1042.85 examples/s][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 30.8619
[36m(ClientAppActor pid=43640)[0m Validation Accuracy: 0.3750[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 31 - Vocab size: 4481[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 31 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=9860)[0m Epoch 100/100, Loss: 30.5136[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 77 - Vocab size: 4481[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 19 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map:   0%|          | 0/39 [00:00<?, ? examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 350.84 examples/s]
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 31.1358[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 44 - Vocab size: 4481[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 59 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 5x across cluster][0m
Map:   0%|          | 0/39 [00:00<?, ? examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 434.99 examples/s]
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 30.3402[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 8 - Vocab size: 4481[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 85 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map:   0%|          | 0/38 [00:00<?, ? examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 1086.23 examples/s]
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 30.9947[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 52 - Vocab size: 4481[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 52 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map:   0%|          | 0/38 [00:00<?, ? examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 1199.95 examples/s]
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 29.3960[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 72 - Vocab size: 4481[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 22 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map:   0%|          | 0/39 [00:00<?, ? examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1053.60 examples/s]
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 29.2555[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 81 - Vocab size: 4481[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 28 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map:   0%|          | 0/39 [00:00<?, ? examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1220.71 examples/s]
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 29.6905[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 54 - Vocab size: 4481[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 54 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map:   0%|          | 0/39 [00:00<?, ? examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1446.63 examples/s]
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 29.3540[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 40 - Vocab size: 4481[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 64 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 28.5730[32m [repeated 4x across cluster][0m
Map:   0%|          | 0/38 [00:00<?, ? examples/s]
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 80 - Vocab size: 4481[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 65 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 1446.72 examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1435.08 examples/s]
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 30.3676[32m [repeated 4x across cluster][0m
Map:   0%|          | 0/38 [00:00<?, ? examples/s]
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 35 - Vocab size: 4481[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 51 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 1113.08 examples/s]
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 29.8229[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 69 - Vocab size: 4481[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 24 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
[92mINFO [0m:      aggregate_fit: received 50 results and 0 failures
Validation Accuracy: 0.5535
[92mINFO [0m:      ðŸ’¡ New best global model found: 0.553488
[92mINFO [0m:      fit progress: (2, 0.6861036164419991, {'centralized_accuracy': 0.5534883720930233}, 216.42512659999193)
[92mINFO [0m:      configure_evaluate: strategy sampled 50 clients (out of 100)
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 24 - Vocab size: 4481[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 24 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 92 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}
[36m(ClientAppActor pid=9860)[0m Validation Accuracy: 0.3750
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 29.6633[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 15 - Vocab size: 4481[32m [repeated 4x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1115.92 examples/s]
Map:   0%|          | 0/38 [00:00<?, ? examples/s]
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 74 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 29x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 1904.57 examples/s]
[36m(ClientAppActor pid=12216)[0m Validation Accuracy: 0.6250[32m [repeated 34x across cluster][0m
[92mINFO [0m:      aggregate_evaluate: received 50 results and 0 failures
[92mINFO [0m:
[92mINFO [0m:      [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 50 clients (out of 100)
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 74 - Vocab size: 4481[32m [repeated 47x across cluster][0m
[36m(ClientAppActor pid=12216)[0m Epoch 100/100, Loss: 24.0002
[36m(ClientAppActor pid=12216)[0m Validation Accuracy: 0.5000[32m [repeated 15x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1486.27 examples/s][32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 14 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 24x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 60 - Vocab size: 4481[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=9860)[0m Epoch 100/100, Loss: 26.3940[32m [repeated 4x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 1476.94 examples/s]
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 57 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=45540)[0m [92mINFO [0m:      Client 37 - Vocab size: 4481[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=12216)[0m Epoch 100/100, Loss: 26.7237[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 2 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 44 - Vocab size: 4481[32m [repeated 5x across cluster][0m
Map:   0%|          | 0/39 [00:00<?, ? examples/s]
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1510.69 examples/s]
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 27.8506[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 8 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 8 - Vocab size: 4481[32m [repeated 5x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1163.79 examples/s]
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 26.2077[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 31 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 45 - Vocab size: 4481[32m [repeated 3x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 39/39 [00:00<00:00, 1454.27 examples/s]
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 26.6058[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 67 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 67 - Vocab size: 4481[32m [repeated 5x across cluster][0m
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 38/38 [00:00<00:00, 1768.71 examples/s]
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 27.0842[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 39 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 39 - Vocab size: 4481[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 25.1004[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=43640)[0m [92mINFO [0m:      Client 36 - Loaded best params: {'vocab_size': 50000, 'embedding_dim': 256, 'num_filters': 128, 'kernel_size': 3, 'max_length': 512}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=9860)[0m [92mINFO [0m:      Client 47 - Vocab size: 4481[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=43640)[0m Epoch 100/100, Loss: 25.8401[32m [repeated 4x across cluster][0m
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[92mINFO [0m:      aggregate_fit: received 37 results and 13 failures
Validation Accuracy: 0.5674
[92mINFO [0m:      ðŸ’¡ New best global model found: 0.567442
[92mINFO [0m:      fit progress: (3, 0.6770257694380624, {'centralized_accuracy': 0.5674418604651162}, 284.8968135000032)
[92mINFO [0m:      configure_evaluate: strategy sampled 50 clients (out of 100)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=43640, ip=127.0.0.1, actor_id=638ea3efa6bacfbdcf9d07c101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002433F996330>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

[92mINFO [0m:      aggregate_evaluate: received 0 results and 50 failures
[92mINFO [0m:
[92mINFO [0m:      [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 50 clients (out of 100)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12216, ip=127.0.0.1, actor_id=f892a644f51aff4df1df2ef001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001B11D6025A0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9860, ip=127.0.0.1, actor_id=1290a9535b4bfe3922fa015201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000209065E69C0>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
[91mERROR [0m:     Traceback (most recent call last):
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 186, in process_message
    raise ex
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\server\superlink\fleet\vce\backend\raybackend.py", line 174, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 477, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\client\message_handler\message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 64, in client_fn
    best_params = load_best_params()
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\OneDrive - Phenikaa University\PYTHON\code2024\CNN_FOR_TEXT_TEST\CNN_TEXT\client_app.py", line 17, in load_best_params
    raise ValueError("Model parameters not found in pyproject.toml. Please ensure server has optimized them.")
ValueError: Model parameters not found in pyproject.toml. Please ensure server has optimized them.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=45540, ip=127.0.0.1, actor_id=9d489a66ba0e2ad7e1ed369401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002A5DA396A50>)
  File "python\\ray\\_raylet.pyx", line 1888, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1996, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1895, in ray._raylet.execute_task
  File "python\\ray\\_raylet.pyx", line 1835, in ray._raylet.execute_task.function_executor
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\_private\function_manager.py", line 689, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\ray\util\tracing\tracing_helper.py", line 463, in _resume_span
    return method(self, *_args, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khanh\anaconda3\envs\FL\Lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException:
Exception ClientAppException occurred. Message: Model parameters not found in pyproject.toml. Please ensure server has optimized them.
